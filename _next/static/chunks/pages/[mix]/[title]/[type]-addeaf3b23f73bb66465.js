_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[10],{BsWD:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("a3WO");function o(e,t){if(e){if("string"===typeof e)return Object(n.a)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(n.a)(e,t):void 0}}},KQm4:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("a3WO");var o=r("BsWD");function c(e){return function(e){if(Array.isArray(e))return Object(n.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},"N+kb":function(e,t,r){"use strict";r.r(t),r.d(t,"__N_SSG",(function(){return S}));var n=r("q1tI"),o=r.n(n),c=r("ODXe"),a=r("KQm4"),f=o.a.createElement,s=13.5,i={4:"/stepcharts/arrow4.svg",6:"/stepcharts/arrow6.svg",8:"/stepcharts/arrow8.svg",12:"/stepcharts/arrow6.svg",16:"/stepcharts/arrow16.svg",shock:"/stepcharts/arrowShock.svg",freeze:"/stepcharts/arrowFreeze.svg"},u={0:"-90deg",1:"180deg",2:"0",3:"90deg"},d=function(e,t){return 4*e*16*t},p=function(e){var t=e.offset,r=e.speed,n={position:"absolute",top:"".concat(d(t,r),"vh"),width:1,height:1};return f("div",{style:n})},h=function(e){var t=e.beat,r=e.direction,n=e.offset,o=e.speed,c={position:"absolute",top:"".concat(d(n,o)-6.75,"vh"),left:"".concat(r*s,"vh"),height:"".concat(s,"vh"),width:"".concat(s,"vh"),background:"url(".concat(i[t],")"),backgroundSize:"cover",transform:"rotate(".concat(u[r],")")};return f("div",{style:c})},l=function(e){var t=e.direction,r=e.offset,n=e.endOffset,c=e.speed,a={position:"absolute",top:"".concat(d(r,c),"vh"),left:"".concat(t*s+.675,"vh"),height:"".concat(4*(n-r-.25)*c*16,"vh"),width:"".concat(12.15,"vh"),backgroundColor:"#5e5"},i={position:"absolute",top:"".concat(d(n-.25,c),"vh"),left:"".concat(t*s+.675,"vh"),height:"".concat(6.075,"vh"),width:"".concat(12.15,"vh"),backgroundColor:"#3b3"};return f(o.a.Fragment,null,f("div",{style:a}),f("div",{style:i}))},v=function(e){var t=e.offset,r=e.speed,n=e.color,o={position:"absolute",height:0,width:"".concat(54,"vh"),left:0,top:"".concat(d(t,r),"vh"),border:"2px solid ".concat(n)};return f("div",{style:o})},m=function(e){var t=e.chart,r=e.speed,n=void 0===r?1:r,c=Math.floor(t.arrows[t.arrows.length-1].offset),s=Object(a.a)(t.arrows).reverse(),i=Object(a.a)(t.freezes).reverse();return f(o.a.Fragment,null,Object(a.a)(Array(4*(c+1))).map((function(e,t){return f(v,{key:"b".concat(t),offset:t/4,speed:n,color:t%4===0?"#888":"#444"})})),t.bpm.map((function(e,t,r){return 0===t?null:r[t-1].bpm<e.bpm?f(v,{key:"ts".concat(t),offset:e.startOffset,speed:n,color:"#fc4"}):f(v,{key:"ts".concat(t),offset:e.startOffset,speed:n,color:"#4cf"})})),t.stops.map((function(e,t){return f(v,{key:"s".concat(t),offset:e.offset,speed:n,color:"#4f4"})})),i.map((function(e,t){return f(l,{key:"f".concat(t),direction:e.direction,offset:e.startOffset,endOffset:e.endOffset,speed:n})})),s.map((function(e,t){var r=e.direction.match(/2/)?"freeze":e.beat;return f(o.a.Fragment,null,e.direction.match(/^1.../)&&f(h,{key:"a".concat(t,"l"),beat:r,direction:0,offset:e.offset,speed:n}),e.direction.match(/^.1../)&&f(h,{key:"a".concat(t,"d"),beat:r,direction:1,offset:e.offset,speed:n}),e.direction.match(/^..1./)&&f(h,{key:"a".concat(t,"u"),beat:r,direction:2,offset:e.offset,speed:n}),e.direction.match(/^...1/)&&f(h,{key:"a".concat(t,"r"),beat:r,direction:3,offset:e.offset,speed:n}),e.direction.match(/^2.../)&&f(h,{key:"a".concat(t,"l"),beat:"freeze",direction:0,offset:e.offset,speed:n}),e.direction.match(/^.2../)&&f(h,{key:"a".concat(t,"d"),beat:"freeze",direction:1,offset:e.offset,speed:n}),e.direction.match(/^..2./)&&f(h,{key:"a".concat(t,"u"),beat:"freeze",direction:2,offset:e.offset,speed:n}),e.direction.match(/^...2/)&&f(h,{key:"a".concat(t,"r"),beat:"freeze",direction:3,offset:e.offset,speed:n}),e.direction.match(/^M.../)&&f(h,{key:"a".concat(t,"l"),beat:"shock",direction:0,offset:e.offset,speed:n}),e.direction.match(/^.M../)&&f(h,{key:"a".concat(t,"d"),beat:"shock",direction:1,offset:e.offset,speed:n}),e.direction.match(/^..M./)&&f(h,{key:"a".concat(t,"u"),beat:"shock",direction:2,offset:e.offset,speed:n}),e.direction.match(/^...M/)&&f(h,{key:"a".concat(t,"r"),beat:"shock",direction:3,offset:e.offset,speed:n}))})),f(p,{offset:c+2,speed:n}))},b=o.a.memo(m),y=function(e){var t=e.offset,r=void 0===t?0:t,n=e.speed,c=void 0===n?1:n,a=e.children,s=o.a.useRef(null),i={position:"relative",width:"".concat(54,"vh"),height:"100vh",backgroundColor:"black",overflow:"scroll"};return o.a.useEffect((function(){s.current&&(s.current.scrollTop=d(r,c)*window.innerHeight/100)}),[s,r,c]),f("div",{ref:s,style:i},a)},w=function(e){var t=e.chart,r=e.speed,n=void 0===r?1:r,o=e.offset;return f(y,{offset:void 0===o?0:o,speed:n},f(b,{chart:t,speed:n}))},k=r("o0o1"),g=r.n(k);function O(e,t,r,n,o,c,a){try{var f=e[c](a),s=f.value}catch(i){return void r(i)}f.done?t(s):Promise.resolve(s).then(n,o)}var x=function(e){var t=e.audioContext,r=e.chart,n=e.offset,c=o.a.useRef(),a=o.a.useRef(),f=o.a.useRef(),s=o.a.useRef();o.a.useEffect((function(){(function(){var e,r=(e=g.a.mark((function e(){var r,n,o,i,u,d,p,h;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=37;break}return e.next=3,fetch("/stepcharts/cursor12.mp3");case 3:return r=e.sent,e.next=6,fetch("/stepcharts/cursor4.mp3");case 6:return n=e.sent,e.next=9,fetch("/stepcharts/cancel1.mp3");case 9:return o=e.sent,e.next=12,fetch("/stepcharts/cursor6.mp3");case 12:return i=e.sent,e.next=15,r.arrayBuffer();case 15:return u=e.sent,e.next=18,n.arrayBuffer();case 18:return d=e.sent,e.next=21,o.arrayBuffer();case 21:return p=e.sent,e.next=24,i.arrayBuffer();case 24:return h=e.sent,e.next=27,t.decodeAudioData(u);case 27:return c.current=e.sent,e.next=30,t.decodeAudioData(d);case 30:return a.current=e.sent,e.next=33,t.decodeAudioData(p);case 33:return f.current=e.sent,e.next=36,t.decodeAudioData(h);case 36:s.current=e.sent;case 37:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var c=e.apply(t,r);function a(e){O(c,n,o,a,f,"next",e)}function f(e){O(c,n,o,a,f,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}})()()}),[t]);var i=o.a.useRef(0);o.a.useEffect((function(){if(t&&c.current&&s.current&&r.arrows[i.current]&&r.arrows[i.current].offset<=n){var e,o=new AudioBufferSourceNode(t),a=r.arrows[i.current].direction.match(/M/);for(o.buffer=a?s.current:c.current,o.connect(t.destination),o.start(),e=i.current+1;r.arrows[e]&&r.arrows[e].offset<=n;e++);i.current=e}}),[n]);var u=o.a.useRef(0);o.a.useEffect((function(){if(t&&a.current&&r.stops[u.current]&&r.stops[u.current].offset<=n){var e,o=new AudioBufferSourceNode(t);for(o.buffer=a.current,o.connect(t.destination),o.start(),e=u.current+1;r.stops[e]&&r.stops[e].offset<=n;e++);u.current=e}}),[n]);var d=o.a.useRef(1);o.a.useEffect((function(){if(t&&f.current&&r.bpm[d.current]&&r.bpm[d.current].startOffset<=n){var e,o=new AudioBufferSourceNode(t);for(o.buffer=f.current,o.connect(t.destination),o.start(),e=d.current+1;r.bpm[e]&&r.bpm[e].startOffset<=n;e++);d.current=e}}),[n]);var p=o.a.useRef(0);return o.a.useEffect((function(){n<p.current&&(i.current=r.arrows.findIndex((function(e){return n<e.offset})),u.current=r.stops.findIndex((function(e){return n<e.offset})),d.current=r.bpm.findIndex((function(e){return n<e.startOffset}))),p.current=n}),[n,r]),null},A=o.a.createElement,j=function(e){var t=e.chart,r=o.a.useRef(),n=o.a.useState(0),f=Object(c.a)(n,2),s=f[0],i=f[1],u=o.a.useState(),d=Object(c.a)(u,2),p=d[0],h=d[1],l=o.a.useRef(0),v=o.a.useMemo((function(){var e=function(e){var t=[].concat(Object(a.a)(e.bpm.map((function(e){return{offset:e.startOffset,bpm:e.bpm}}))),Object(a.a)(e.stops.map((function(e){return{offset:e.offset,stop:e.duration}})))).sort((function(e,t){return e.offset-t.offset})),r=[{time:0,offset:0,bpm:t.shift().bpm}];return t.forEach((function(e){var t=r[0].bpm,n=4*(e.offset-r[0].offset)/t*60,o=r[0].time+n;"bpm"in e?r.unshift({time:o,offset:e.offset,bpm:e.bpm}):(r.unshift({time:o,offset:e.offset,bpm:0}),r.unshift({time:o+e.stop,offset:e.offset,bpm:t}))})),r.reverse()}(t);return function(t){var r;for(r=l.current;e[r+1]&&e[r+1].time<t;r++);return l.current=r,(t-e[r].time)*e[r].bpm/60/4+e[r].offset}}),[t]),m=o.a.useCallback((function(){p||h(new AudioContext),r.current=(new Date).getTime(),l.current=0}),[p,h]);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=o.a.useRef();o.a.useEffect((function(){return t.current=requestAnimationFrame((function r(){t.current=requestAnimationFrame(r),e()})),function(){t.current&&cancelAnimationFrame(t.current)}}),[e])}(o.a.useCallback((function(){r.current?i(v(((new Date).getTime()-r.current)/1e3)):i(0)}),[i])),A("div",{style:{display:"flex"}},A(w,{chart:t,speed:2,offset:s}),A(x,{audioContext:p,chart:t,offset:s}),A("button",{onClick:m},"Play"))},E=o.a.createElement,S=!0;t.default=function(e){var t=e.chart;return E(j,{chart:t})}},ODXe:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("BsWD");function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,c=void 0;try{for(var a,f=e[Symbol.iterator]();!(n=(a=f.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(s){o=!0,c=s}finally{try{n||null==f.return||f.return()}finally{if(o)throw c}}return r}}(e,t)||Object(n.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},a3WO:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,"a",(function(){return n}))},o0o1:function(e,t,r){e.exports=r("ls82")},vnkr:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[mix]/[title]/[type]",function(){return r("N+kb")}])}},[["vnkr",0,2,1]]]);